import SimpleITK as sitk
import matplotlib.pyplot as plt

def visualize_slice(volume, axis, index):
    if axis not in [0, 1, 2]:
        raise ValueError("L'axe doit être 0 (YZ), 1 (XZ) ou 2 (XY).")

    
    size = volume.GetSize()
    if index < 0 or index >= size[axis]:
        raise ValueError(f"L'indice doit être compris entre 0 et {size[axis] - 1} pour l'axe {axis}.")

   
    extractor = sitk.ExtractImageFilter()
    size = list(volume.GetSize())
    size[axis] = 0  
    extractor.SetSize(size)

    index_list = [0, 0, 0]
    index_list[axis] = index
    extractor.SetIndex(index_list)

    slice_2d = extractor.Execute(volume)

    
    slice_array = sitk.GetArrayViewFromImage(slice_2d)

    
    origin = volume.TransformIndexToPhysicalPoint(index_list)

    
    plt.figure(figsize=(6, 6))
    plt.imshow(slice_array, cmap='gray', origin='lower')
    plt.title(f"Coupe sur l'axe {axis} à l'indice {index}\nOrigine (physique) : {origin}")
    plt.axis('on')
    plt.xlabel('X (pixels)')
    plt.ylabel('Y (pixels)')
    plt.colorbar(label='Intensité')
    plt.show()


chemin_du_fichier = r"cheminDuVolume"  
try:
    volume = sitk.ReadImage(chemin_du_fichier)
    print("Volume chargé avec succès.")
except Exception as e:
    print(f"Erreur lors du chargement du fichier : {e}")


try:
    visualize_slice(volume, axis=2, index=50)  
except Exception as e:
    print(f"Erreur lors de la visualisation de la coupe : {e}")
